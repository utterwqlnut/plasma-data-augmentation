[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'v_lr' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'e_lr' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'balance' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_n_head' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_n_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_activation' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_distortion_budget' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_hidden_dim' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_layer_type' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'encoder_n_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'encoder_hidden_dim' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_loss_t' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'viewmaker_loss_weight' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'post_hoc_n_layers' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'post_hoc_h_size' was locked by 'sweep' (ignored update).
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'post_hoc_lr' was locked by 'sweep' (ignored update).
Epoch: 1
Train Losses: Training Encoder Loss: 9.021759033203124e-05 Training Viewmaker Loss: -2.4998511162266367e-05
Val Losses: Val Encoder Loss: 4.863739013671875e-05 Val Viewmaker Loss: -1.347699878806452e-05
Epoch: 2
Train Losses: Training Encoder Loss: 3.299713134765625e-05 Training Viewmaker Loss: -9.143218903773231e-06
Val Losses: Val Encoder Loss: 2.574920654296875e-05 Val Viewmaker Loss: -7.134881877846056e-06
Epoch: 3
Train Losses: Training Encoder Loss: 2.536773681640625e-05 Training Viewmaker Loss: -7.029179732853663e-06
Val Losses: Val Encoder Loss: 1.02996826171875e-05 Val Viewmaker Loss: -2.85395269656874e-06
Epoch: 4
Train Losses: Training Encoder Loss: 6.67572021484375e-06 Training Viewmaker Loss: -1.8497841551834426e-06
Val Losses: Val Encoder Loss: 3.62396240234375e-06 Val Viewmaker Loss: -1.0041685413852975e-06
Epoch: 5
Train Losses: Training Encoder Loss: 3.0517578125e-06 Training Viewmaker Loss: -8.456156024294614e-07
Val Losses: Val Encoder Loss: 9.5367431640625e-07 Val Viewmaker Loss: -2.642548793119204e-07
Epoch: 6
Train Losses: Training Encoder Loss: 5.7220458984375e-07 Training Viewmaker Loss: -1.5855292758715223e-07
Val Losses: Val Encoder Loss: 1.71661376953125e-06 Val Viewmaker Loss: -4.7565878276145667e-07
Epoch: 7
Train Losses: Training Encoder Loss: 1.71661376953125e-06 Training Viewmaker Loss: -4.7565878276145667e-07
Val Losses: Val Encoder Loss: 9.5367431640625e-07 Val Viewmaker Loss: -2.642548793119204e-07
Epoch: 8
Train Losses: Training Encoder Loss: 1.9073486328125e-06 Training Viewmaker Loss: -5.285097586238408e-07
Val Losses: Val Encoder Loss: 9.5367431640625e-07 Val Viewmaker Loss: -2.642548793119204e-07
Epoch: 9
Train Losses: Training Encoder Loss: 3.814697265625e-07 Training Viewmaker Loss: -1.0570195172476815e-07
Val Losses: Val Encoder Loss: -1.9073486328125e-07 Val Viewmaker Loss: 5.285097586238407e-08
Epoch: 10
Train Losses: Training Encoder Loss: 1.1444091796875e-06 Training Viewmaker Loss: -3.1710585517430446e-07
Val Losses: Val Encoder Loss: 5.7220458984375e-07 Val Viewmaker Loss: -1.5855292758715223e-07
/usr/local/Caskroom/miniconda/base/envs/plasma-aug/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 due to no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Traceback (most recent call last):
  File "/Users/dhruvachayapathy/personal/research/mit-research/plasma-data-augmentation/src/main.py", line 87, in <module>
    best_model = train_post_hoc(train_dataloader=train_dataloader, val_dataloader=test_dataloader, model=model,optim=adam,loss_fn=loss_fn, save_metric=save_metric, num_epochs=post_hoc_num_epochs)
  File "/Users/dhruvachayapathy/personal/research/mit-research/plasma-data-augmentation/src/train.py", line 42, in train_post_hoc
    accuracy, f1, auc = compute_metrics(out,labels)
  File "/Users/dhruvachayapathy/personal/research/mit-research/plasma-data-augmentation/src/eval.py", line 10, in compute_metrics
    return accuracy_score(labels, binary_out), f1_score(labels, binary_out), roc_auc_score(labels, binary_out)
  File "/usr/local/Caskroom/miniconda/base/envs/plasma-aug/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/Caskroom/miniconda/base/envs/plasma-aug/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 640, in roc_auc_score
    return _average_binary_score(
  File "/usr/local/Caskroom/miniconda/base/envs/plasma-aug/lib/python3.10/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/usr/local/Caskroom/miniconda/base/envs/plasma-aug/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 382, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.